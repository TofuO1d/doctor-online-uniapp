import{_ as a}from"./uni-icons.306a74c1.js";import{q as e,o as t,d as s,f as l,w as i,F as u,g as n,t as o,e as r,l as c,i as d,j as f,k as m,a as p,L as _,h as g}from"./index-0333b418.js";import{r as v}from"./uni-app.es.6fb9258e.js";import{a as y,b as h}from"./uni-list.cc31cbe4.js";import{_ as x}from"./scroll-page.1487e938.js";import{p as b,_ as j}from"./payment.0592d585.js";import{p as w,c as k}from"./medicine.0c3b3592.js";import{h as F}from"./http.dd4042ae.js";import{_ as q}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-popup.15682734.js";const C=q({__name:"index",props:{id:String},setup(q){const C=q,D=e({}),I=e({}),P=e(""),z=e();function A(){}async function K({index:a}){if(0===a)return uni.utils.toast("暂不支持微信支付!");const{code:e,data:t,message:s}=await b({orderId:P.value,paymentMethod:a,payCallback:"http://localhost/subpkg_medicine/pay_result/index"});if(1e4!==e)return uni.utils.toast(s);window.location.href=t.payUrl}async function L(){const{code:a,data:e,message:t}=await k(C.id,I.value.id);if(1e4!==a)return uni.utils.toast(t);P.value=e.id,z.value.open()}return async function(){const{code:a,data:e,message:t}=await F.get("/patient/order/address");if(1e4!==a)return uni.utils.toast(t);I.value=e[0]}(),async function(){if(!C.id)return;const{code:a,data:e,message:t}=await w(C.id);if(1e4!==a)return uni.utils.toast(t);D.value=e}(),(e,b)=>{const w=v(c("uni-icons"),a),k=d,F=f,q=g,C=v(c("uni-list-item"),y),M=v(c("uni-list"),h),R=m,S=v(c("scroll-page"),x),U=v(c("custom-payment"),j);return t(),s(u,null,[l(S,{"background-color":"#f6f6f6"},{default:i((()=>[l(k,{class:"medicine-page"},{default:i((()=>[l(k,{class:"page-header"},{default:i((()=>[l(k,{class:"order-shippment"},{default:i((()=>[l(k,{class:"region"},{default:i((()=>[l(w,{size:"16",color:"#FF7702",type:"location-filled"}),n(" "+o(I.value.city)+" "+o(I.value.county),1)])),_:1}),l(k,{class:"detail"},{default:i((()=>[n(o(I.value.addressDetail),1)])),_:1}),l(k,{class:"receiver"},{default:i((()=>[n(o(I.value.receiver)+" "+o(I.value.mobile),1)])),_:1})])),_:1})])),_:1}),l(k,{class:"order-shop"},{default:i((()=>[n(" 优医药房 "),l(F,{class:"alt"},{default:i((()=>[n("优医质保 假一赔十")])),_:1})])),_:1}),l(k,{class:"medicine-list"},{default:i((()=>[(t(!0),s(u,null,r(D.value.medicines,(a=>(t(),p(k,{key:a.id,class:"medicine-list-item"},{default:i((()=>[l(q,{class:"medicine-cover",src:a.avatar,mode:"aspectFill"},null,8,["src"]),l(k,{class:"medicine-info"},{default:i((()=>[l(F,{class:"name"},{default:i((()=>[n(o(a.name),1)])),_:2},1024),l(F,{class:_([{symbol:1===a.prescriptionFlag},"symbol"])},{default:i((()=>[n(o(a.specs),1)])),_:2},1032,["class"]),l(F,{class:"price"},{default:i((()=>[n("¥"+o(a.amount),1)])),_:2},1024)])),_:2},1024),l(k,{class:"quantity"},{default:i((()=>[n("x"+o(a.quantity),1)])),_:2},1024),l(k,{class:"guide"},{default:i((()=>[n("用法用量："+o(a.usageDosag),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),l(k,{class:"order-info"},{default:i((()=>[l(M,{border:!1},{default:i((()=>[l(C,{title:"药品金额","right-text":"¥"+D.value.payment},null,8,["right-text"]),l(C,{title:"运费","right-text":"¥"+D.value.expressFee},null,8,["right-text"]),l(C,{title:"优惠券","show-arrow":"","right-text":"-¥"+D.value.couponDeduction},null,8,["right-text"]),l(C,{title:"实付款","right-text":"¥"+D.value.actualPayment},null,8,["right-text"])])),_:1})])),_:1}),l(k,{class:"toolbar"},{default:i((()=>[l(k,{class:"total-amount"},{default:i((()=>[n(" 需付款: "),l(F,{class:"number"},{default:i((()=>[n("¥"+o(D.value.actualPayment),1)])),_:1})])),_:1}),l(k,{class:"buttons"},{default:i((()=>[l(R,{onClick:L,class:"uni-button"},{default:i((()=>[n("立即支付")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),l(U,{onClose:A,onConfirm:K,amount:D.value.actualPayment,"order-id":P.value,ref_key:"paymentRef",ref:z},null,8,["amount","order-id"])],64)}}},[["__scopeId","data-v-5ff96b7c"]]);export{C as default};
