import{q as e,l as t,o,a as s,w as a,f as l,g as n,E as u,G as i,H as r,j as d,i as c,k as h,m,J as p,n as f,t as y,A as _,c as w,d as g,F as b,u as v}from"./index-0333b418.js";import{_ as k}from"./uni-icons.306a74c1.js";import{r as C}from"./uni-app.es.6fb9258e.js";import{_ as x}from"./uni-easyinput.f5dc7f12.js";import{_ as S,a as T}from"./uni-forms.a2627eed.js";import{l as M,a as I,v as D}from"./user.b6661fd7.js";import{u as q}from"./http.dd4042ae.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";const U={options:{styleIsolation:"shared"}},V=z(Object.assign(U,{__name:"password",setup(p){const f=q(),y=e(!1),_=e(),w=e({mobile:"",password:""}),g={mobile:{rules:[{required:!0,errorMessage:"请填写手机号码"},{pattern:"^1\\d{10}$",errorMessage:"手机号码格式不正确"}]},password:{rules:[{required:!0,errorMessage:"请输入验证码"},{pattern:"^[a-zA-Z0-9]{8}$",errorMessage:"密码格式不正确"}]}};function b(){y.value=!y.value}async function v(){if(!y.value)return uni.utils.toast("请先同意协议!");try{const e=await _.value.validate(),{code:t,data:o,message:s}=await M(e);if(1e4!==t)return uni.utils.toast(s);f.token=o.token,f.userId=o.id,"switchTab"===f.openType?u({url:f.redirectURL}):i({url:f.redirectURL})}catch(e){console.log(e)}}return(e,u)=>{const i=C(t("uni-easyinput"),x),p=C(t("uni-forms-item"),S),f=r,k=d,M=c,I=h,D=m,q=C(t("uni-forms"),T);return o(),s(q,{class:"login-form",model:w.value,rules:g,ref_key:"formRef",ref:_},{default:a((()=>[l(p,{name:"mobile"},{default:a((()=>[l(i,{modelValue:w.value.mobile,"onUpdate:modelValue":u[0]||(u[0]=e=>w.value.mobile=e),"input-border":!1,clearable:!1,placeholder:"请输入手机号","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),l(p,{name:"password"},{default:a((()=>[l(i,{modelValue:w.value.password,"onUpdate:modelValue":u[1]||(u[1]=e=>w.value.password=e),type:"password",placeholder:"请输入密码","input-border":!1,"placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),l(M,{class:"agreement"},{default:a((()=>[l(f,{onClick:b,checked:y.value,color:"#16C2A3"},null,8,["checked"]),n(" 我已同意 "),l(k,{class:"link"},{default:a((()=>[n("用户协议")])),_:1}),n(" 及 "),l(k,{class:"link"},{default:a((()=>[n("隐私协议")])),_:1})])),_:1}),l(I,{onClick:v,class:"uni-button"},{default:a((()=>[n("登 录")])),_:1}),l(D,{"hover-class":"none",class:"uni-navigator",url:" "},{default:a((()=>[n(" 忘记密码？ ")])),_:1})])),_:1},8,["model"])}}}),[["__scopeId","data-v-91f5e126"]]),j={en:{"uni-countdown.day":"day","uni-countdown.h":"h","uni-countdown.m":"m","uni-countdown.s":"s"},"zh-Hans":{"uni-countdown.day":"天","uni-countdown.h":"时","uni-countdown.m":"分","uni-countdown.s":"秒"},"zh-Hant":{"uni-countdown.day":"天","uni-countdown.h":"時","uni-countdown.m":"分","uni-countdown.s":"秒"}},{t:F}=p(j);const H=z({name:"UniCountdown",emits:["timeup"],props:{showDay:{type:Boolean,default:!0},showHour:{type:Boolean,default:!0},showMiniute:{type:Boolean,default:!0},showColon:{type:Boolean,default:!0},start:{type:Boolean,default:!0},backgroundColor:{type:String,default:""},color:{type:String,default:"#333"},fontSize:{type:Number,default:14},splitorColor:{type:String,default:"#333"},day:{type:Number,default:0},hour:{type:Number,default:0},minute:{type:Number,default:0},second:{type:Number,default:0},timestamp:{type:Number,default:0}},data:()=>({timer:null,syncFlag:!1,d:"00",h:"00",i:"00",s:"00",leftTime:0,seconds:0}),computed:{dayText:()=>F("uni-countdown.day"),hourText:e=>F("uni-countdown.h"),minuteText:e=>F("uni-countdown.m"),secondText:e=>F("uni-countdown.s"),timeStyle(){const{color:e,backgroundColor:t,fontSize:o}=this;return{color:e,backgroundColor:t,fontSize:`${o}px`,width:22*o/14+"px",lineHeight:20*o/14+"px",borderRadius:3*o/14+"px"}},splitorStyle(){const{splitorColor:e,fontSize:t,backgroundColor:o}=this;return{color:e,fontSize:12*t/14+"px",margin:o?4*t/14+"px":""}}},watch:{day(e){this.changeFlag()},hour(e){this.changeFlag()},minute(e){this.changeFlag()},second(e){this.changeFlag()},start:{immediate:!0,handler(e,t){if(e)this.startData();else{if(!t)return;clearInterval(this.timer)}}}},created:function(e){this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.countDown()},unmounted(){clearInterval(this.timer)},methods:{toSeconds:(e,t,o,s,a)=>e?e-parseInt((new Date).getTime()/1e3,10):60*t*60*24+60*o*60+60*s+a,timeUp(){clearInterval(this.timer),this.$emit("timeup")},countDown(){let e=this.seconds,[t,o,s,a]=[0,0,0,0];e>0?(t=Math.floor(e/86400),o=Math.floor(e/3600)-24*t,s=Math.floor(e/60)-24*t*60-60*o,a=Math.floor(e)-24*t*60*60-60*o*60-60*s):this.timeUp(),t<10&&(t="0"+t),o<10&&(o="0"+o),s<10&&(s="0"+s),a<10&&(a="0"+a),this.d=t,this.h=o,this.i=s,this.s=a},startData(){if(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.seconds<=0)return this.seconds=this.toSeconds(0,0,0,0,0),void this.countDown();clearInterval(this.timer),this.countDown(),this.timer=setInterval((()=>{this.seconds--,this.seconds<0?this.timeUp():this.countDown()}),1e3)},update(){this.startData()},changeFlag(){this.syncFlag||(this.seconds=this.toSeconds(this.timestamp,this.day,this.hour,this.minute,this.second),this.startData(),this.syncFlag=!0)}}},[["render",function(e,t,u,i,r,h){const m=d,p=c;return o(),s(p,{class:"uni-countdown"},{default:a((()=>[u.showDay?(o(),s(m,{key:0,style:f([h.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[n(y(r.d),1)])),_:1},8,["style"])):_("",!0),u.showDay?(o(),s(m,{key:1,style:f([h.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[n(y(h.dayText),1)])),_:1},8,["style"])):_("",!0),u.showHour?(o(),s(m,{key:2,style:f([h.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[n(y(r.h),1)])),_:1},8,["style"])):_("",!0),u.showHour?(o(),s(m,{key:3,style:f([h.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[n(y(u.showColon?":":h.hourText),1)])),_:1},8,["style"])):_("",!0),u.showMiniute?(o(),s(m,{key:4,style:f([h.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[n(y(r.i),1)])),_:1},8,["style"])):_("",!0),u.showMiniute?(o(),s(m,{key:5,style:f([h.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[n(y(u.showColon?":":h.minuteText),1)])),_:1},8,["style"])):_("",!0),l(m,{style:f([h.timeStyle]),class:"uni-countdown__number"},{default:a((()=>[n(y(r.s),1)])),_:1},8,["style"]),u.showColon?_("",!0):(o(),s(m,{key:6,style:f([h.splitorStyle]),class:"uni-countdown__splitor"},{default:a((()=>[n(y(h.secondText),1)])),_:1},8,["style"]))])),_:1})}],["__scopeId","data-v-7eade36a"]]),R={options:{styleIsolation:"shared"}},B=z(Object.assign(R,{__name:"mobile",setup(m){const p=q(),f=e(!1),_=e(!1),w=e("获取验证码"),g=e(),b=e({mobile:"",code:""}),v={mobile:{rules:[{required:!0,errorMessage:"请填写手机号码"},{pattern:"^1\\d{10}$",errorMessage:"手机号码格式不正确"}]},code:{rules:[{required:!0,errorMessage:"请输入验证码"},{pattern:"^\\d{6}$",errorMessage:"验证码格式不正确"}]}};function k(){f.value=!f.value}async function M(){if(!f.value)return uni.utils.toast("请先同意协议!");try{const e=await g.value.validate(),{code:t,data:o,message:s}=await I(e);if(1e4!==t)return uni.utils.toast(s);p.token=o.token,p.userId=o.id,"switchTab"===p.openType?u({url:p.redirectURL}):i({url:p.redirectURL})}catch(e){console.log(e)}}function z(){w.value="重新获取验证码",_.value=!1}async function U(){try{await g.value.validateField(["mobile"]);const{code:e,message:t}=await D({mobile:b.value.mobile,type:"login"});if(1e4!==e)return uni.utils.toast(t);uni.utils.toast("验证码已发送，请查收!"),_.value=!0}catch(e){console.log(e)}}return(e,u)=>{const i=C(t("uni-easyinput"),x),m=C(t("uni-forms-item"),S),p=C(t("custom-countdown"),H),I=c,D=d,q=r,V=h,j=C(t("uni-forms"),T);return o(),s(I,null,{default:a((()=>[l(j,{class:"login-form",model:b.value,rules:v,ref_key:"formRef",ref:g},{default:a((()=>[l(m,{name:"mobile"},{default:a((()=>[l(i,{modelValue:b.value.mobile,"onUpdate:modelValue":u[0]||(u[0]=e=>b.value.mobile=e),"input-border":!1,clearable:!1,placeholder:"请输入手机号","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"])])),_:1}),l(m,{name:"code"},{default:a((()=>[l(i,{modelValue:b.value.code,"onUpdate:modelValue":u[1]||(u[1]=e=>b.value.code=e),"input-border":!1,clearable:!1,placeholder:"请输入验证码","placeholder-style":"color: #C3C3C5"},null,8,["modelValue"]),_.value?(o(),s(I,{key:0,class:"text-button"},{default:a((()=>[l(p,{second:59,"show-day":!1,"show-hour":!1,"show-miniute":!1,onTimeup:z,color:"#16C2A3"}),n(" 秒后重新获取 ")])),_:1})):(o(),s(D,{key:1,onClick:U,class:"text-button"},{default:a((()=>[n(y(w.value),1)])),_:1}))])),_:1}),l(I,{class:"agreement"},{default:a((()=>[l(q,{onClick:k,checked:f.value,color:"#16C2A3"},null,8,["checked"]),n(" 我已同意 "),l(D,{class:"link"},{default:a((()=>[n("用户协议")])),_:1}),n(" 及 "),l(D,{class:"link"},{default:a((()=>[n("隐私协议")])),_:1})])),_:1}),l(V,{onClick:M,class:"uni-button"},{default:a((()=>[n("登 录")])),_:1})])),_:1},8,["model"])])),_:1})}}}),[["__scopeId","data-v-4dc73113"]]),N=z({__name:"index",setup(u){const i=[{title:"密码登录",subTitle:"验证码登录"},{title:"验证码登录",subTitle:"密码登录"}],r=e(1),h=w((()=>i[r.value]));function m(){r.value=Math.abs(r.value-1)}function p(){window.location.href="https://graph.qq.com/oauth2.0/authorize?response_type=token&client_id=102015968&redirect_uri=http://consult-patients.itheima.net/pages/login/qq"}return(e,u)=>{const i=c,f=d,w=C(t("uni-icons"),k);return o(),g(b,null,[l(i,{class:"user-login"},{default:a((()=>[l(i,{class:"login-type"},{default:a((()=>[l(i,{class:"title"},{default:a((()=>[n(y(v(h).title),1)])),_:1}),l(i,{class:"type"},{default:a((()=>[l(f,{onClick:m},{default:a((()=>[n(y(v(h).subTitle),1)])),_:1}),l(w,{color:"#3c3e42",type:"forward"})])),_:1})])),_:1}),0===r.value?(o(),s(V,{key:0})):_("",!0),1===r.value?(o(),s(B,{key:1})):_("",!0)])),_:1}),l(i,{class:"social-login"},{default:a((()=>[l(i,{class:"legend"},{default:a((()=>[l(f,{class:"text"},{default:a((()=>[n("其它方式登录")])),_:1})])),_:1}),l(i,{class:"social-account"},{default:a((()=>[l(i,{onClick:p,class:"icon"},{default:a((()=>[l(w,{color:"#00b0fb",size:"30",type:"qq"})])),_:1}),l(i,{class:"icon"},{default:a((()=>[l(w,{color:"#07C160",size:"30",type:"weixin"})])),_:1})])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-9c8b97c7"]]);export{N as default};
