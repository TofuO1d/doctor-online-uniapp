"use strict";const e=require("../../common/vendor.js"),t=require("../../services/medicine.js"),i=require("../../services/address.js"),n=require("../../services/payment.js");if(require("../../utils/http.js"),require("../../stores/user.js"),!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("scroll-page")+e.resolveComponent("custom-payment"))()}Math||((()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../components/scroll-page/scroll-page.js")+(()=>"../../components/custom-payment/custom-payment.js"))();const s={__name:"index",props:{id:String},setup(s){const a=s,o=e.ref({}),r=e.ref({}),u=e.ref(""),l=e.ref();function c(){}async function p({index:t}){if(0===t)return e.index.utils.toast("暂不支持微信支付!");const{code:i,data:s,message:a}=await n.paymentApi({orderId:u.value,paymentMethod:t,payCallback:"http://localhost:5173/#/subpkg_medicine/pay_result/index"});if(1e4!==i)return e.index.utils.toast(a);window.location.href=s.payUrl}async function d(){const{code:i,data:n,message:s}=await t.createOrderApi(a.id,r.value.id);if(1e4!==i)return e.index.utils.toast(s);u.value=n.id,l.value.open()}return async function(){const{code:t,data:n,message:s}=await i.addressListApi();if(1e4!==t)return e.index.utils.toast(s);r.value=n[0]}(),async function(){if(!a.id)return;const{code:i,data:n,message:s}=await t.preOrderApi(a.id);if(1e4!==i)return e.index.utils.toast(s);o.value=n}(),(t,i)=>({a:e.p({size:"16",color:"#FF7702",type:"location-filled"}),b:e.t(r.value.city),c:e.t(r.value.county),d:e.t(r.value.addressDetail),e:e.t(r.value.receiver),f:e.t(r.value.mobile),g:e.f(o.value.medicines,((t,i,n)=>({a:t.avatar,b:e.t(t.name),c:e.t(t.specs),d:1===t.prescriptionFlag?1:"",e:e.t(t.amount),f:e.t(t.quantity),g:e.t(t.usageDosag),h:t.id}))),h:e.p({title:"药品金额","right-text":"¥"+o.value.payment}),i:e.p({title:"运费","right-text":"¥"+o.value.expressFee}),j:e.p({title:"优惠券","show-arrow":!0,"right-text":"-¥"+o.value.couponDeduction}),k:e.p({title:"实付款","right-text":"¥"+o.value.actualPayment}),l:e.p({border:!1}),m:e.t(o.value.actualPayment),n:e.o(d),o:e.p({"background-color":"#f6f6f6"}),p:e.sr(l,"7f73e882-7",{k:"paymentRef"}),q:e.o(c),r:e.o(p),s:e.p({amount:o.value.actualPayment,"order-id":u.value})})}};wx.createPage(s);
