"use strict";const e=require("../../common/vendor.js"),a=require("../../services/patient.js");if(require("../../utils/http.js"),require("../../stores/user.js"),!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-data-checkbox")+e.resolveComponent("uni-forms")+e.resolveComponent("scroll-page"))()}Math||((()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms/uni-forms.js")+(()=>"../../components/scroll-page/scroll-page.js"))();const n={__name:"index",props:{id:String},setup(n){const r=n,o=e.ref(),t=e.ref({name:"",idCard:"",gender:1,defaultFlag:0}),l={name:{rules:[{required:!0,errorMessage:"请填写患者姓名"},{pattern:"^[一-龥]{2,5}$",errorMessage:"患者姓名为2-5位中文"}]},idCard:{rules:[{required:!0,errorMessage:"请输入身份证号"},{pattern:"^[1-9]\\d{5}(?:18|19|20)\\d{2}(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\\d|30|31)\\d{3}[\\dXx]$",errorMessage:"身份证号格式不正确"}]},gender:{rules:[{required:!0,errorMessage:"请勾选患者姓名"},{validateFunction:(e,a,n,r)=>(n.idCard.slice(16,17)%2!==a&&r("选择的性别与身份号中性别不一致"),!0)}]}};async function i(){try{await o.value.validate();r.id?async function(){const{code:n,message:r}=await a.updatePatientApi(t.value);if(1e4!==n)return e.index.utils.toast(r);e.index.navigateBack()}():async function(){const{code:n,message:r}=await a.addPatientApi(t.value);if(1e4!==n)return e.index.utils.toast(r);e.index.navigateBack()}()}catch(n){console.log(n)}}function s(e){t.value.defaultFlag=e.detail.value?1:0}return async function(){if(!r.id)return;e.index.setNavigationBarTitle({title:"编辑患者"});const{code:n,data:{genderValue:o,age:l,...i}}=await a.patientDetailApi(r.id);t.value=i}(),(a,n)=>({a:e.o((e=>t.value.name=e)),b:e.p({"placeholder-style":"color: #C3C3C5; font-size: 32rpx",styles:{color:"#121826"},"input-border":!1,clearable:!1,placeholder:"请填写真实姓名",modelValue:t.value.name}),c:e.p({label:"患者姓名",name:"name"}),d:e.o((e=>t.value.idCard=e)),e:e.p({"placeholder-style":"color: #C3C3C5; font-size: 32rpx",styles:{color:"#121826"},"input-border":!1,clearable:!1,placeholder:"请填写身份证号",modelValue:t.value.idCard}),f:e.p({label:"患者身份证号",name:"idCard"}),g:e.o((e=>t.value.gender=e)),h:e.p({selectedColor:"#16C2A3",localdata:[{text:"男",value:1},{text:"女",value:0}],modelValue:t.value.gender}),i:e.p({label:"患者性别",name:"gender"}),j:e.o(s),k:1===t.value.defaultFlag,l:e.p({label:"默认就诊人"}),m:e.o(i),n:e.sr(o,"d324b002-1,d324b002-0",{k:"formRef"}),o:e.p({border:!0,"label-width":"220rpx",model:t.value,rules:l})})}};wx.createPage(n);
