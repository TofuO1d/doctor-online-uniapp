"use strict";const e=require("../../../common/vendor.js"),r=require("../../../services/user.js"),s=require("../../../stores/user.js");if(require("../../../utils/http.js"),!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();const o={options:{styleIsolation:"shared"}},n=Object.assign(o,{__name:"password",setup(o){const n=s.useUserStore(),t=e.ref(!1),a=e.ref(),i=e.ref({mobile:"",password:""}),u={mobile:{rules:[{required:!0,errorMessage:"请填写手机号码"},{pattern:"^1\\d{10}$",errorMessage:"手机号码格式不正确"}]},password:{rules:[{required:!0,errorMessage:"请输入验证码"},{pattern:"^[a-zA-Z0-9]{8}$",errorMessage:"密码格式不正确"}]}};function l(){t.value=!t.value}async function d(){if(!t.value)return e.index.utils.toast("请先同意协议!");try{const s=await a.value.validate(),{code:o,data:t,message:i}=await r.loginByPassword(s);if(1e4!==o)return e.index.utils.toast(i);n.token=t.token,n.userId=t.id,"switchTab"===n.openType?e.index.switchTab({url:n.redirectURL}):e.index.redirectTo({url:n.redirectURL})}catch(s){console.log(s)}}return(r,s)=>({a:e.o((e=>i.value.mobile=e)),b:e.p({"input-border":!1,clearable:!1,placeholder:"请输入手机号","placeholder-style":"color: #C3C3C5",modelValue:i.value.mobile}),c:e.p({name:"mobile"}),d:e.o((e=>i.value.password=e)),e:e.p({type:"password",placeholder:"请输入密码","input-border":!1,"placeholder-style":"color: #C3C3C5",modelValue:i.value.password}),f:e.p({name:"password"}),g:e.o(l),h:t.value,i:e.o(d),j:e.sr(a,"e20f1b0a-0",{k:"formRef"}),k:e.p({model:i.value,rules:u})})}});wx.createComponent(n);
